(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{601:(e,t,r)=>{Promise.resolve().then(r.bind(r,9485))},9485:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>j});var s=r(5155),a=r(2115),l=r(3464),i=r(908),n=r(5998),o=r(2056),c=r(6983),d=r(1362),x=r(1045),b=r(8149),g=r(6621),m=r(5196),u=r(2619),p=r.n(u),h=r(5870),v=r(9865);function j(){let[e,t]=(0,a.useState)(!1),[r,u]=(0,a.useState)("all"),[j,f]=(0,a.useState)("none"),[y,w]=(0,a.useState)("idle"),[N,C]=(0,a.useState)([]),[S,A]=(0,a.useState)(!0),[k,E]=(0,a.useState)(null),{user:z}=(0,m.A)();(0,a.useEffect)(()=>{(async()=>{try{A(!0);let e=await fetch("/api/licenses");if(!e.ok)throw Error("Failed to fetch licenses");let t=await e.json();C(t),E(null)}catch(e){console.error("Error fetching licenses:",e),E("Failed to load license data. Please try again later.")}finally{A(!1)}})()},[]);let _=(0,a.useMemo)(()=>({total:N.length,expired:N.filter(e=>"Expired"===e.computedStatus).length,warning:N.filter(e=>"Expiring Soon"===e.computedStatus).length,active:N.filter(e=>"Active"===e.computedStatus).length}),[N]),T=(0,a.useMemo)(()=>N.filter(e=>"expired"===r?"Expired"===e.computedStatus:"warning"===r?"Expiring Soon"===e.computedStatus:"active"!==r||"Active"===e.computedStatus),[N,r]);return(0,s.jsxs)("div",{className:"min-h-screen pb-12 bg-[rgb(var(--bg-primary))]",children:[(0,s.jsx)("nav",{className:"bg-[rgb(var(--bg-primary))] shadow-sm border-b border-[rgb(var(--border-color))] sticky top-0 z-30",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex justify-between h-16",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"bg-blue-600 p-2 rounded-lg text-white",children:(0,s.jsx)(l.A,{size:24})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-xl font-bold text-[rgb(var(--text-primary))]",children:"LicenseGuard"}),(0,s.jsx)("p",{className:"text-xs text-[rgb(var(--text-secondary))]",children:"ระบบติดตามใบอนุญาต"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(g.U,{}),z?(0,s.jsxs)(p(),{href:"/admin",className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors",children:[(0,s.jsx)(h.A,{size:18}),"Admin"]}):(0,s.jsxs)(p(),{href:"/login",className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-[rgb(var(--text-secondary))] hover:text-[rgb(var(--accent))] border border-[rgb(var(--border-color))] hover:bg-[rgb(var(--bg-secondary))] rounded-lg transition-colors",children:[(0,s.jsx)(v.A,{size:18}),"เข้าสู่ระบบ"]}),(0,s.jsxs)("button",{onClick:()=>t(!0),className:"flex items-center gap-2 text-sm font-medium text-[rgb(var(--text-secondary))] hover:text-[rgb(var(--accent))] px-3 py-2 rounded-md hover:bg-[rgb(var(--bg-secondary))] transition-colors",children:[(0,s.jsx)(i.A,{size:18}),"คำแนะนำ Tech Stack"]}),(0,s.jsxs)("button",{onClick:()=>{w("sending"),setTimeout(()=>{w("sent"),setTimeout(()=>w("idle"),3e3),alert("[จำลอง] ส่งแจ้งเตือนไปยัง LINE OA เรียบร้อยแล้ว!\n\nรายการแจ้งเตือน:\n- หมดอายุ: ".concat(_.expired," รายการ\n- ใกล้หมด: ").concat(_.warning," รายการ"))},1500)},disabled:"idle"!==y,className:"flex items-center gap-2 px-4 py-2 rounded-lg text-white font-medium transition-all ".concat("sent"===y?"bg-green-500":"sending"===y?"bg-gray-400":"bg-[#00B900] hover:bg-[#009900]"),children:[(0,s.jsx)(n.A,{size:18}),"sending"===y?"Sending...":"sent"===y?"Sent!":"Notify LINE"]})]})]})})}),(0,s.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-8",children:[(0,s.jsxs)("div",{className:"bg-gradient-to-r from-blue-700 to-blue-900 rounded-2xl p-8 text-white shadow-lg relative overflow-hidden",children:[(0,s.jsx)("div",{className:"absolute right-0 top-0 h-full w-1/3 bg-white opacity-5 skew-x-12 transform translate-x-12"}),(0,s.jsx)("h2",{className:"text-3xl font-bold mb-2",children:"ภาพรวมใบอนุญาต"}),(0,s.jsxs)("p",{className:"text-blue-100 max-w-2xl",children:["ตรวจสอบสถานะวันหมดอายุของใบอนุญาต (Registration), แยกตามบริษัท และแจ้งเตือนอัตโนมัติ ข้อมูลอัปเดตล่าสุด: ",new Date().toLocaleDateString("th-TH")]})]}),S&&(0,s.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}),k&&(0,s.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-700",children:[(0,s.jsx)("p",{className:"font-semibold",children:"Error"}),(0,s.jsx)("p",{children:k})]}),!S&&!k&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,s.jsx)(x.C,{title:"ใบอนุญาตทั้งหมด",count:_.total,icon:(0,s.jsx)(l.A,{className:"text-blue-600",size:24}),colorClass:"bg-blue-100",isActive:"all"===r,onClick:()=>u("all")}),(0,s.jsx)(x.C,{title:"หมดอายุแล้ว",count:_.expired,icon:(0,s.jsx)(o.A,{className:"text-red-600",size:24}),colorClass:"bg-red-100",isActive:"expired"===r,onClick:()=>u("expired")}),(0,s.jsx)(x.C,{title:"ใกล้หมดอายุ (90 วัน)",count:_.warning,icon:(0,s.jsx)(c.A,{className:"text-yellow-600",size:24}),colorClass:"bg-yellow-100",isActive:"warning"===r,onClick:()=>u("warning")}),(0,s.jsx)(x.C,{title:"ใช้งานปกติ",count:_.active,icon:(0,s.jsx)(d.A,{className:"text-green-600",size:24}),colorClass:"bg-green-100",isActive:"active"===r,onClick:()=>u("active")})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center bg-[rgb(var(--bg-primary))] p-4 rounded-lg shadow-sm border border-[rgb(var(--border-color))] gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 w-full sm:w-auto",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-[rgb(var(--text-primary))] whitespace-nowrap",children:"Group By:"}),(0,s.jsxs)("div",{className:"flex rounded-md shadow-sm w-full sm:w-auto",role:"group",children:[(0,s.jsx)("button",{type:"button",onClick:()=>f("none"),className:"px-4 py-2 text-sm font-medium rounded-l-lg border transition-colors ".concat("none"===j?"bg-blue-600 text-white border-blue-600":"bg-[rgb(var(--bg-secondary))] text-[rgb(var(--text-primary))] border-[rgb(var(--border-color))] hover:bg-[rgb(var(--bg-tertiary))]"),children:"None"}),(0,s.jsx)("button",{type:"button",onClick:()=>f("company"),className:"px-4 py-2 text-sm font-medium border-t border-b transition-colors ".concat("company"===j?"bg-blue-600 text-white border-blue-600":"bg-[rgb(var(--bg-secondary))] text-[rgb(var(--text-primary))] border-[rgb(var(--border-color))] hover:bg-[rgb(var(--bg-tertiary))]"),children:"Company"}),(0,s.jsx)("button",{type:"button",onClick:()=>f("tag"),className:"px-4 py-2 text-sm font-medium rounded-r-lg border transition-colors ".concat("tag"===j?"bg-blue-600 text-white border-blue-600":"bg-[rgb(var(--bg-secondary))] text-[rgb(var(--text-primary))] border-[rgb(var(--border-color))] hover:bg-[rgb(var(--bg-tertiary))]"),children:"Tag"})]})]}),(0,s.jsxs)("div",{className:"text-sm text-[rgb(var(--text-secondary))]",children:["แสดงข้อมูล ",T.length," รายการ จากทั้งหมด ",N.length]})]}),(0,s.jsx)(b.I,{data:T,groupBy:j})]})]})]})}}},e=>{e.O(0,[241,339,39,441,255,358],()=>e(e.s=601)),_N_E=e.O()}]);